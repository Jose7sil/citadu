{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/*!\n=========================================================\n* Proyecto: mssr-pays-integration\n* Componente : BuySubscription\n* Autor : José silva (RationalIT)\n* Versión : 1.0.0\n=========================================================\n*/\nimport React, { Component, useState } from \"react\";\nimport Select from \"react-select\"; // nodejs library that concatenates classes\n\nimport classnames from \"classnames\"; // reactstrap components\n\nimport environment from '../../environments/environments';\nimport { NavItem, NavLink, Nav, TabContent, TabPane, Container, Row, Col, Button, Card, CardBody, CardFooter, CardTitle } from \"reactstrap\";\n/*!=======================================================\n  * Nombre: Products\n  * Descripción: Carga la informacion de productos para renderizar en pantalla\n  =========================================================*/\n\nclass Products extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"API_URI_AWS\", environment.apiUrlAws);\n\n    this.state = {\n      tabs: \"1d\",\n      setTabs: \"1d\",\n      ivTabs: 1,\n      setivTabs: 1,\n      products: [],\n      dataphone: [],\n      dataproducts: [],\n      exchanges: \"\",\n      categoria: \"plus\",\n      duracion: \"1d\",\n      precio: 0,\n      value: 0\n    };\n    this.getProducts = this.getProducts.bind(this, props);\n    this.productLocal = this.productLocal.bind(this);\n  }\n  /*!=======================================================\n  * Nombre: componentDidMount\n  * Descripción: Se ejecuta antes del render\n  =========================================================*/\n\n\n  componentDidMount() {\n    this.getProducts();\n  }\n  /*!=======================================================\n  * Nombre: getProducts\n  * Descripción: Obtener todos los productos\n  =========================================================*/\n\n\n  async getProducts(props) {\n    //Seteando valores props/dataphone en el State\n    this.setState({\n      dataphone: props\n    });\n    const body = await fetch(`${this.API_URI_AWS}/products/list/all`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json, text/plain, */*'\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (data) {\n      let body = {};\n\n      if (data.statusCode === \"200\") {\n        body = data.body;\n        return body;\n      } else {\n        return body;\n      }\n    }).catch(err => console.log('#Error#', err)); //Seteando valores de productos en el State de acuerdo al exchange\n\n    if (body.exchanges) {\n      for (let k in body.exchanges) {\n        const valor = body.exchanges[k];\n        this.setState({\n          value: valor\n        });\n      }\n\n      this.setState({\n        dataproducts: JSON.parse(JSON.stringify(body.products)),\n        products: JSON.parse(JSON.stringify(body.products)),\n        exchanges: body.exchanges\n      });\n      this.productLocal(body);\n    } else {\n      this.setState({\n        products: body.products\n      });\n    }\n  }\n  /*!=======================================================\n   * Nombre: productLocal\n   * Descripción: Funcion para obtener la data en la moneda \n     local/pais por defecto y convertir.\n   =========================================================*/\n\n\n  productLocal(data, country) {\n    let pais = country ? country : this.state.dataphone.dataphone.rs.country.countryCode;\n    let val = data.value ? data.value : \"\"; //Validacion lista Country/Moneda\n\n    let exc = {\n      label: pais,\n      value: val\n    };\n\n    if (data.exchanges) {\n      for (let k in data.exchanges) {\n        if (k !== exc.label) continue;\n        exc.value = data.exchanges[k];\n      }\n    } //Transformacion de valores, segun la moneda y valor de exchange (exc.value !== \"\")\n\n\n    if (exc.value !== \"\") {\n      let temporal = JSON.parse(JSON.stringify(this.state.dataproducts));\n      this.state.products.forEach((e, i) => {\n        for (let dias in e.price) {\n          for (let dat in e.price[dias]) {\n            if (dat === \"save\") continue;\n            temporal[i][\"price\"][dias][dat] = e.price[dias][dat] * exc.value;\n            temporal[i][\"currency\"] = this.state.dataphone.dataphone.rs.country.currencyCode;\n          }\n        }\n      });\n      this.setState({\n        products: temporal\n      });\n    } else {\n      this.setState({\n        products: this.state.dataproducts\n      });\n    }\n  }\n\n  render() {\n    /****************** toggleTabs Tab principal planes ******************/\n    const toggleTabsCategoria = (e, stateName, index, product, i, precio) => {\n      e.preventDefault(); //console.log('toggleTabsCategoria::', product)\n      //console.log('toggleTabsCategoria::', i)\n\n      this.setState({\n        categoria: product,\n        precio: precio\n      });\n\n      switch (stateName) {\n        case \"ivTabs\":\n          this.setState({\n            ivTabs: index\n          });\n          break;\n      }\n    };\n\n    const toggleTabsDuracion = (e, stateName, index, product, i, precio) => {\n      e.preventDefault();\n      this.setState({\n        duracion: i,\n        precio: precio\n      });\n\n      switch (stateName) {\n        case \"tabs\":\n          //Seteando valores en el State\n          this.setState({\n            tabs: index\n          });\n          break;\n\n        default:\n      }\n    };\n\n    const selectChange = (data, country) => {\n      this.productLocal(data, data.pais);\n    };\n\n    const pay = async (e, method, currency) => {\n      //e.preventDefault();\n      //console.log('method', method);\n      //console.log('currency', currency);\n      let table;\n      let detail = {};\n\n      if (method == \"paypal\") {\n        table = this.state.dataproducts.filter(data => data.product.toLowerCase() === this.state.categoria.toLowerCase());\n      }\n\n      if ((method == \"transbank\" || method == \"transfer\") && currency != \"CLP\") {\n        await this.productLocal(this.state, '');\n        table = this.state.products.filter(data => data.product.toLowerCase() === this.state.categoria.toLowerCase());\n      } else {\n        table = this.state.products.filter(data => data.product.toLowerCase() === this.state.categoria.toLowerCase());\n      }\n\n      table.forEach(data => {\n        for (let dia in data.price) {\n          if (dia !== this.state.duracion) continue;\n          detail = data.price[dia];\n          detail['method'] = method;\n        }\n\n        localStorage.setItem('table', JSON.stringify(table));\n        localStorage.setItem('detail', JSON.stringify(detail));\n      });\n    };\n    /******************product*****************/\n\n\n    let tabPane = []; //Variable tabPanel para mostrar todo el detalle del plan\n\n    let NavItemSecundary = []; // Almacena la navegacion secundaria de cada plan (EJEMPLO:  1 DIA , 2 DIAS , 3 DIASS)\n\n    let TabPaneSecundary = []; // Almacena detalle de cada plan\n\n    let dataPhone = {};\n    let dPhone = [];\n    let ccy = [];\n    const ivTa = this.state.ivTabs;\n    const tabs = this.state.tabs;\n    let tab = 'tab';\n    let ordered = \"\";\n    let ivTabs = 'ivTabs';\n    let estado = this.state;\n    let exchanges = estado.exchanges;\n    dataPhone = estado.dataphone.dataphone;\n    const renObjNavItem = this.state.products.map(function (data, idx) {\n      NavItemSecundary = [];\n      TabPaneSecundary = [];\n      dPhone = [];\n      ccy = [];\n      let j = idx + 1;\n      const selectedValue = {};\n      dPhone.push( /*#__PURE__*/_jsx(\"div\", {\n        className: \"title my-2\",\n        children: /*#__PURE__*/_jsxs(\"h5\", {\n          children: [\" \", dataPhone.rs.username, \" (\", dataPhone.rs.phoneNumber, \")\"]\n        }, idx)\n      }, idx)); //Validacion lista Country/Moneda\n\n      let exc = {\n        label: \"\",\n        value: \"\"\n      };\n\n      for (let k in exchanges) {\n        exc.value = exchanges[k];\n        exc.label = k;\n      }\n\n      let crrcy = [{\n        label: \"USD(USA)\",\n        pais: \"USA\",\n        value: \"\",\n        code: \"USD\"\n      }];\n\n      if (exc.label === dataPhone.rs.country.countryCode) {\n        selectedValue['label'] = dataPhone.rs.country.currencyCode + \"(\" + dataPhone.rs.country.countryNameEn + \")\";\n        selectedValue['value'] = exc.value;\n        selectedValue['pais'] = dataPhone.rs.country.countryCode;\n        selectedValue['code'] = dataPhone.rs.country.currencyCode;\n        crrcy.push({\n          'label': dataPhone.rs.country.currencyCode + \"(\" + dataPhone.rs.country.countryNameEn + \")\",\n          'value': exc.value,\n          'pais': dataPhone.rs.country.countryCode,\n          'code': dataPhone.rs.country.currencyCode\n        });\n        ccy.push( /*#__PURE__*/_jsx(Select, {\n          className: \"react-select react-select-info\",\n          classNamePrefix: \"react-select\",\n          options: crrcy,\n          onChange: e => selectChange(e, 'country'),\n          defaultValue: selectedValue\n        }, idx));\n      } //ORDENANDO JSON PRICE\n\n      /*ordered= Object.keys(data.price)\n          .sort()\n          .reduce((acc, key) => ({\n              ...acc, [key]: data.price[key]\n          }), {})*/\n      //ORDENANDO JSON PRICE\n\n\n      ordered = Object.keys(data.price).sort().reduce((obj, key) => {\n        obj[key] = data.price[key];\n        return obj;\n      }, {}); //Recorremos ordered para pintar los dias del plan\n\n      for (let i in ordered) {\n        /****************** Inicio Navegación secundaria detalle dias PLAN******************/\n        let amt = ordered[i].amt;\n        NavItemSecundary.push( /*#__PURE__*/_jsx(NavItem, {\n          className: \"nav-linkpay\",\n          children: /*#__PURE__*/_jsx(NavLink, {\n            className: classnames({\n              active: tabs === i\n            }),\n            onClick: e => toggleTabsDuracion(e, \"tabs\", i, data.product, i, amt),\n            children: i\n          })\n        }, i));\n        /******************* Fin Navegación secundaria detalle DIAS PLAN ******************/\n\n        /****************** Inicio TabPane  Navegación secundaria detalle DIAS PLAN ******************/\n\n        tab = 'tab' + i;\n        TabPaneSecundary.push( /*#__PURE__*/_jsx(TabPane, {\n          tabId: tab,\n          children: /*#__PURE__*/_jsxs(Card, {\n            className: \"card-pricing card-plain mt-2\",\n            children: [/*#__PURE__*/_jsxs(CardTitle, {\n              className: \"my-0\",\n              tag: \"h2\",\n              children: [data.currency, \" \", amt]\n            }), /*#__PURE__*/_jsxs(\"ul\", {\n              className: \"mt-0 mb-0\",\n              children: [/*#__PURE__*/_jsxs(\"li\", {\n                children: [/*#__PURE__*/_jsx(\"i\", {\n                  className: \"tim-icons icon-money-coins\"\n                }), /*#__PURE__*/_jsx(\"del\", {\n                  children: ordered[i].old\n                })]\n              }), /*#__PURE__*/_jsxs(\"li\", {\n                children: [/*#__PURE__*/_jsx(\"i\", {\n                  className: \"tim-icons icon-cart\"\n                }), ordered[i].save]\n              })]\n            })]\n          })\n        }, tab));\n        /****************** Fin TabPane Navegación secundaria detalle DIAS PLAN ******************/\n      } //console.log('estado.categoria}',estado.categoria,estado.duracion);\n\n\n      const newdesc = data.description.replace(/\\n/g, '<br />');\n      /*****************Inicio TabPane donde se pinta todo el detalle de cada plan NAVEGACION PRINCIPAL******************/\n\n      ivTabs = 'ivTabs' + j;\n      tabPane.push( /*#__PURE__*/_jsxs(TabPane, {\n        tabId: ivTabs,\n        children: [/*#__PURE__*/_jsx(Row, {\n          children: /*#__PURE__*/_jsxs(Col, {\n            className: \"ml-auto mr-auto \",\n            lg: \"10\",\n            md: \"10\",\n            sm: \"12\",\n            children: [/*#__PURE__*/_jsx(\"h5\", {\n              className: \"description mb-1\",\n              dangerouslySetInnerHTML: {\n                __html: newdesc\n              }\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"title text-left my-1\",\n              children: /*#__PURE__*/_jsx(\"h3\", {\n                className: \"mb-1 h3\",\n                children: \"Tiempo\"\n              })\n            })]\n          })\n        }), /*#__PURE__*/_jsx(Row, {\n          children: /*#__PURE__*/_jsx(Col, {\n            className: \"ml-auto mr-auto\",\n            lg: \"10\",\n            md: \"10\",\n            sm: \"12\",\n            children: /*#__PURE__*/_jsx(Card, {\n              className: \"card-coin card-plain mt-0\",\n              children: /*#__PURE__*/_jsxs(CardBody, {\n                children: [/*#__PURE__*/_jsx(Nav, {\n                  className: \"nav-tabs-primary justify-content-center px-0\",\n                  tabs: true,\n                  children: NavItemSecundary\n                }), /*#__PURE__*/_jsx(TabContent, {\n                  className: \"tab-subcategories mt-2\",\n                  activeTab: \"tab\" + tabs,\n                  children: TabPaneSecundary\n                })]\n              })\n            })\n          })\n        }), /*#__PURE__*/_jsx(Row, {\n          children: /*#__PURE__*/_jsx(Col, {\n            className: \"ml-auto mr-auto\",\n            lg: \"10\",\n            sm: \"12\",\n            md: \"10\",\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: \"title text-left my-1\",\n              children: /*#__PURE__*/_jsx(\"h3\", {\n                className: \"mb-1 h3\",\n                children: \"M\\xE9todo de Pago\"\n              })\n            })\n          })\n        }), /*#__PURE__*/_jsx(Row, {\n          className: \"mt-2\",\n          children: /*#__PURE__*/_jsxs(Col, {\n            className: \"ml-auto mr-auto \",\n            lg: \"10\",\n            md: \"10\",\n            sm: \"12\",\n            children: [/*#__PURE__*/_jsxs(Row, {\n              className: \"text-center\",\n              children: [/*#__PURE__*/_jsxs(Col, {\n                className: \"text-center\",\n                lg: \"6\",\n                md: \"6\",\n                sm: \"12\",\n                children: [/*#__PURE__*/_jsxs(Button, {\n                  onClick: e => pay(e, 'paypal', ''),\n                  href: `/checkout/${estado.categoria}/${estado.duracion}`,\n                  className: \"ml-0 btn-grad w-100\",\n                  color: \"primary\",\n                  children: [\"Paypal\\xA0\", /*#__PURE__*/_jsx(\"i\", {\n                    className: \"tim-icons icon-money-coins\"\n                  })]\n                }), /*#__PURE__*/_jsx(\"p\", {\n                  children: \"* Pago en dolares.\"\n                })]\n              }), /*#__PURE__*/_jsx(Col, {\n                className: \"text-center\",\n                lg: \"6\",\n                md: \"6\",\n                sm: \"12\",\n                children: /*#__PURE__*/_jsxs(Button, {\n                  onClick: e => pay(e, 'transbank', data.currency),\n                  href: `/checkout/${estado.categoria}/${estado.duracion}`,\n                  className: \"mr-0 btn-grad w-100\",\n                  color: \"primary\",\n                  children: [\"Transbank\\xA0\", /*#__PURE__*/_jsx(\"i\", {\n                    className: \"tim-icons icon-bank\"\n                  })]\n                })\n              })]\n            }), /*#__PURE__*/_jsx(Row, {\n              className: \"text-center mt-3\",\n              children: /*#__PURE__*/_jsx(Col, {\n                className: \"ml-auto mr-auto \",\n                md: \"8\",\n                children: /*#__PURE__*/_jsxs(Button, {\n                  onClick: e => pay(e, 'transfer', data.currency),\n                  href: `/transfer/${estado.categoria}/${estado.duracion}`,\n                  className: \"btn-grad w-100\",\n                  color: \"primary\",\n                  children: [\"Transferencia \", /*#__PURE__*/_jsx(\"i\", {\n                    className: \"tim-icons icon-bank\"\n                  })]\n                })\n              })\n            })]\n          })\n        })]\n      }, ivTabs));\n      /*****************Fin TabPane donde se pinta todo el detalle de cada plan NAVEGACION PRINCIPAL******************/\n\n      let nameicon = data.product.toLowerCase();\n      let icon = '';\n      /****************** Navegación principal ejemplo PLUS , TEAM , VIP ******************/\n\n      return /*#__PURE__*/_jsx(NavItem, {\n        className: \"nav-item-plan bcplan\",\n        children: /*#__PURE__*/_jsx(NavLink, {\n          className: classnames({\n            active: ivTa === j\n          }),\n          onClick: e => toggleTabsCategoria(e, \"ivTabs\", j, data.product),\n          href: \"#\",\n          children: /*#__PURE__*/_jsx(\"img\", {\n            src: `/assets/img/planes/p_${nameicon}_f.png`,\n            alt: \"...\",\n            className: \"img-plan\"\n          })\n        })\n      }, j);\n    });\n    /***************** Integrando toda la pantalla******************/\n\n    let activeTabivTabs = this.state.ivTabs;\n    return /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsxs(Row, {\n        children: [/*#__PURE__*/_jsx(Col, {\n          lg: \"5\",\n          md: \"4\",\n          sm: \"12\",\n          children: dPhone\n        }), /*#__PURE__*/_jsx(Col, {\n          lg: \"7\",\n          md: \"8\",\n          sm: \"12\",\n          children: /*#__PURE__*/_jsxs(Row, {\n            children: [/*#__PURE__*/_jsx(Col, {\n              lg: \"6\",\n              md: \"6\",\n              sm: \"12\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \"title my-2\",\n                children: /*#__PURE__*/_jsx(\"h5\", {\n                  className: \"ml-0 text-md-right text-lg-right\",\n                  children: \"Mostrar valores en \"\n                })\n              })\n            }), /*#__PURE__*/_jsx(Col, {\n              lg: \"6\",\n              md: \"6\",\n              sm: \"12\",\n              children: ccy\n            })]\n          })\n        })]\n      }, activeTabivTabs), /*#__PURE__*/_jsx(\"div\", {\n        className: \"title text-center my-1\",\n        children: /*#__PURE__*/_jsx(\"h3\", {\n          className: \"h3\",\n          children: \"Seleccione una Categor\\xEDa\"\n        })\n      }), /*#__PURE__*/_jsx(Nav, {\n        className: \"nav-pills-just-icons justify-content-center px-1\",\n        pills: true,\n        role: \"tablist\",\n        children: renObjNavItem\n      }), /*#__PURE__*/_jsx(Card, {\n        className: \"card-pay\",\n        children: /*#__PURE__*/_jsx(CardBody, {\n          children: /*#__PURE__*/_jsx(TabContent, {\n            className: \"justify-content-center\",\n            activeTab: \"ivTabs\" + activeTabivTabs,\n            children: tabPane\n          })\n        })\n      })]\n    });\n  }\n\n}\n/*!=======================================================\n  * Nombre: BuySubscription\n  * Descripción: \n  =========================================================*/\n\n\nexport default function BuySubscription(props) {\n  React.useEffect(() => {}, []);\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsx(\"div\", {\n      className: \"product-page\",\n      id: \"buysuscription\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"section section-pills justify-content-center\",\n        children: [/*#__PURE__*/_jsx(\"img\", {\n          alt: \"...\",\n          className: \"path shape\",\n          src: \"/assets/img/background/shape-s.png\"\n        }), /*#__PURE__*/_jsx(Container, {\n          children: /*#__PURE__*/_jsx(\"div\", {\n            id: \"navigation-pills\",\n            children: /*#__PURE__*/_jsx(Row, {\n              children: /*#__PURE__*/_jsx(Col, {\n                className: \"ml-auto mr-auto\",\n                lg: \"7\",\n                md: \"10\",\n                sm: \"12\",\n                children: /*#__PURE__*/_jsxs(Card, {\n                  className: \"register\",\n                  children: [/*#__PURE__*/_jsx(CardBody, {\n                    children: /*#__PURE__*/_jsx(Products, _objectSpread({}, props))\n                  }), /*#__PURE__*/_jsx(CardFooter, {})]\n                })\n              })\n            })\n          })\n        })]\n      })\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}